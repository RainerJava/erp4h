<?xml version="1.0" encoding="utf-8" ?>
<System>
	
	<M_CB_NAME500>
		SELECT
			RTRIM(M.NAME_CODE) AS CODE
			,RTRIM(M.NAME_NAME) AS NAME
			,RTRIM(M.NAME_RNAME) AS RNAME
			,RTRIM(M.DEFAULT_TYPE) AS DEFAULT_TYPE
		FROM
			M_NAME AS M
		WHERE M.NAMECLS_CODE = ? 
			AND M.DSP_FLG = '0'
		ORDER BY M.DSPORDER_NO, M.NAME_CODE
	</M_CB_NAME500>
	

	<M_COLOR001>
		SELECT
			COLOR_CODE,
			COLORCLS_CODE,
			COLOR_NAME,
			COLOR_RNAME
		FROM
			M_COLOR
		$WHERE
		ORDER BY DSPORDER_NO
	</M_COLOR001>
	
		<M_COLOR002>
		SELECT
			COLOR_CODE,
			COLORCLS_CODE,
			COLOR_NAME,
			COLOR_RNAME
		FROM
			M_COLOR
		WHERE COLORCLS_CODE = 'STATE' AND DSP_FLG = '0'
		ORDER BY DSPORDER_NO
	</M_COLOR002>
	
	<M_CB_EMP501>
		SELECT
			RTRIM(M.EMP_CODE) AS EMP_CODE
			,RTRIM(M.EMP_KANA) AS EMP_KANA
			,RTRIM(M.EMP_NAME) AS EMP_NAME
			,RTRIM(M.EMP_TNAME) AS EMP_TNAME
		FROM
			M_EMP AS M
		WHERE
			M.USE_FLG = '0'
	</M_CB_EMP501>
	
	<M_EMP_COMBO001>
		SELECT EMP_USER
		      ,EMP_KANA
		      ,EMP_NAME
		      ,EMP_TNAME
		FROM M_EMP E 
		WHERE E.USE_FLG = '0'
	</M_EMP_COMBO001>
	
	<M_CB_USERGRP500>
		SELECT
			RTRIM(M.USERGID) AS USERGID
			,RTRIM(M.USERTXT) AS USERTXT
		FROM
			M_USERGRP AS M
		ORDER BY M.USERGID
	</M_CB_USERGRP500>
	
	<!--Add by HUNG NV 2010.04.05 13h40-->
	<!-- begin: getDataForComboBoxInMCtlFrame -->
	<M_CB_CTL500>
	  SELECT RTRIM(M.C_KEY) AS C_KEY
		   , RTRIM(M.C_NAME) AS C_NAME
		FROM M_CTL AS M
	</M_CB_CTL500>
	<!-- end: getDataForComboBoxInMCtlFrame -->
	
	<M_CB_USERGRP508>	
	DECLARE @SortOrder TINYINT
	SET @SortOrder = (
	        SELECT CAST(SUBSTRING(C_DATA, 1, 1)AS INT)
	        FROM   M_CTL
	        WHERE  USERID = 'SYSTEM'
	               AND C_KEY = 'SCH_USER'
	    )
	 
	SELECT RTRIM(M.USERGID) AS USERGID,
	       RTRIM(M.USERTXT) AS USERTXT
	FROM   M_USERGRP AS M
	WHERE  RTRIM(M.USERGID)NOT LIKE(
	           SELECT RTRIM(C_DATA)
	           FROM   M_CTL
	           WHERE  USERID LIKE 'SYSTEM'
	                  AND C_KEY = 'Z_SYSUSR'
	       )
	ORDER BY
	       CASE 
	            WHEN @SortOrder = 1 THEN M.USERGID
	            WHEN @SortOrder = 2 THEN M.USERTXT
	            ELSE M.USERGID
	       END
	</M_CB_USERGRP508>
	
	<M_CB_USER509>
	SELECT RTRIM(M.EMP_CODE) AS EMPCODE
	     , RTRIM(M.EMP_TNAME) AS EMPNAME
	  FROM M_EMP AS M
  ORDER BY CASE WHEN (SELECT CAST( SUBSTR(C_DATA, 1, 1) AS INT) FROM M_CTL WHERE USERID = 'SYSTEM'AND C_KEY = 'SCH_EMP') = 1 THEN M.EMP_CODE
                WHEN (SELECT CAST( SUBSTR(C_DATA, 1, 1) AS INT) FROM M_CTL WHERE USERID = 'SYSTEM'AND C_KEY = 'SCH_EMP') = 2 THEN M.EMP_NAME
                WHEN (SELECT CAST( SUBSTR(C_DATA, 1, 1) AS INT) FROM M_CTL WHERE USERID = 'SYSTEM'AND C_KEY = 'SCH_EMP') = 3 THEN M.EMP_KANA
                WHEN (SELECT CAST( SUBSTR(C_DATA, 1, 1) AS INT) FROM M_CTL WHERE USERID = 'SYSTEM'AND C_KEY = 'SCH_EMP') = 9 THEN M.OLD_CODE
	            ELSE M.EMP_CODE
	        END
	</M_CB_USER509>
	
	<M_CB_MENUEXE510>
	    SELECT (MENUGRP_CODE ||'-' ||MENUEXE_CODE) AS ID,
	    MENUEXE_NAME AS NAME
	    FROM   M_MENUEXE
	    WHERE  MENUEXE_NAME IS NOT NULL
  </M_CB_MENUEXE510>
  
	<M_CB_INSPAREA500>
	SELECT NAMECLS_CODE
      ,NAME_CODE
      ,NAME_NAME
      ,NAME_RNAME
      ,DEFAULT_TYPE
      ,DSP_FLG
      ,DSPORDER_NO
      ,NAMETYPE
      ,ADD_USER
      ,ADD_PC
      ,ADD_DATE
      ,ADD_TIME
      ,LASTUP_USER
      ,LASTUP_PC
      ,LASTUP_DATE
      ,LASTUP_TIME
	FROM M_NAME AS M
	WHERE M.NAMECLS_CODE = 'INSPAREA' 
	</M_CB_INSPAREA500>
	
	<M_CB_DPNTFLG500>
	SELECT NAMECLS_CODE
      ,NAME_CODE
      ,NAME_NAME
      ,NAME_RNAME
      ,DEFAULT_TYPE
      ,DSP_FLG
      ,DSPORDER_NO
      ,NAMETYPE
      ,ADD_USER
      ,ADD_PC
      ,ADD_DATE
      ,ADD_TIME
      ,LASTUP_USER
      ,LASTUP_PC
      ,LASTUP_DATE
      ,LASTUP_TIME
	FROM M_NAME AS M
	WHERE M.NAMECLS_CODE = 'DPNTFLG' 
	</M_CB_DPNTFLG500>
	
	<M_CB_COLORCLS001>
		SELECT
			RTRIM(M.COLORCLS_CODE) AS COLORCLS_CODE,
			RTRIM(M.COLORCLS_NAME) AS COLORCLS_NAME,
			M.HELP,
			M.USE_FLG,
			M.DSP_SEQ
		FROM
			M_COLORCLS AS M
	</M_CB_COLORCLS001>
	
	<M_CB_CUSTTYPE001>
		SELECT NAME_CODE AS CODE,NAME_NAME AS NAME FROM M_NAME WHERE NAMECLS_CODE = 'CUSTTYPE'
	</M_CB_CUSTTYPE001>


	<M_CB_LOGIN601>
			SELECT
				M.EMP_CODE,
				M.EMP_NAME,
				M.EMP_TNAME,
				M.USER_USER,
				M.EMP_USER
			FROM
				M_EMP AS M
			WHERE M.USE_FLG = '0'
			ORDER BY 
	          M.DSPORDER_NO,
	          M.EMP_CODE 
	</M_CB_LOGIN601>

<!-- Add by HungNV 2010.06.24 09h10-->

<M_CB_PDMETER500>
	SELECT
		NAME_NAME,
		NAME_CODE,
		DEFAULT_TYPE
	FROM 
		M_NAME
	WHERE 
		NAMECLS_CODE = 'PDMETER'
</M_CB_PDMETER500>

<M_CB_BENDER500>
	SELECT 
		NAME_NAME,
		NAME_CODE,
		DEFAULT_TYPE
	FROM 
		M_NAME
	WHERE 
		NAMECLS_CODE = 'BENDERR'
</M_CB_BENDER500>

<M_CB_PROCTYPE500>
	SELECT 
		NAME_NAME,
		NAME_CODE,
		DEFAULT_TYPE
	FROM 
		M_NAME
	WHERE 
		NAMECLS_CODE = 'PROC'
</M_CB_PROCTYPE500>

<M_CB_SUPPTYPE500>
	SELECT 
		NAME_NAME,
		NAME_CODE,
		DEFAULT_TYPE
	FROM 
		M_NAME
	WHERE 
		NAMECLS_CODE = 'SUPPTYPE'
</M_CB_SUPPTYPE500>

<M_CB_LCLS501>
		SELECT 
			M.LCLS_CODE,
			M.LCLS_KANA,
		    M.LCLS_NAME,
		    M.LCLS_TNAME,
		    M.SEARCHIDX,
		    M.USE_FLG,
		    M.LASTUP_USER,
		    M.LASTUP_PC,
		    M.LASTUP_DATE,
		    M.LASTUP_TIME
		FROM
			M_LCLS AS M
		WHERE 
			M.USE_FLG = '0'
		ORDER BY 
			M.LCLS_CODE
</M_CB_LCLS501>

<M_CB_MCLS501>
		SELECT 
			M.LCLS_CODE,
			M.MCLS_CODE,
			M.MCLS_KANA,
		    M.MCLS_NAME,
		    M.MCLS_TNAME,
		    M.SEARCHIDX,
		    M.USE_FLG,
		    M.LASTUP_USER,
		    M.LASTUP_PC,
		    M.LASTUP_DATE,
		    M.LASTUP_TIME,
		    M.SUS_TYPE
		FROM
			M_MCLS AS M   
		$WHERE 
		ORDER BY 
			M.LCLS_CODE, M.MCLS_CODE 
</M_CB_MCLS501>


<M_CB_MCLS502>
		SELECT 
			M.LCLS_CODE,
			M.MCLS_CODE,
			M.MCLS_KANA,
		    M.MCLS_NAME,
		    M.MCLS_TNAME,
		    M.SEARCHIDX,
		    M.USE_FLG,
		    M.LASTUP_USER,
		    M.LASTUP_PC,
		    M.LASTUP_DATE,
		    M.LASTUP_TIME,
		    M.SUS_TYPE
		FROM
			M_MCLS AS M   
		WHERE 
			M.LCLS_CODE = ? AND M.MCLS_CODE = ?
</M_CB_MCLS502>

<M_CB_MCLS503>
		SELECT 
			SPCL_TYPE
		FROM
			M_MCLS AS M   
		WHERE 
			M.LCLS_CODE = ? AND M.MCLS_CODE = ?
</M_CB_MCLS503>



<M_CB_SCLS501>
		SELECT 
			M.LCLS_CODE,
			M.MCLS_CODE,
			M.SCLS_CODE,
			M.SCLS_KANA,
		    M.SCLS_NAME,
		    M.SCLS_TNAME,
		    M.SEARCHIDX,
		    M.USE_FLG,
		    M.LASTUP_USER,
		    M.LASTUP_PC,
		    M.LASTUP_DATE,
		    M.LASTUP_TIME
		FROM
			M_SCLS AS M
		WHERE
			M.LCLS_CODE = ?
			AND
			M.MCLS_CODE = ?
			AND
			M.USE_FLG = '0' 
</M_CB_SCLS501>

	<M_CB_MSIZE001>
		SELECT
			SIZE_CODE,
			SIZE_KANA,
			SIZE_NAME,
			SIZE_TNAME,
			DSPORDER_NO,
			LCLS_CODE,
			MCLS_CODE,
			SCLS_CODE,
			OLD_CODE,
			SEARCHIDX,
			USE_FLG,
			ADD_USER,
			ADD_PC,
			ADD_DATE,
			ADD_TIME,
			LASTUP_USER,
			LASTUP_PC,
			LASTUP_DATE,
			LASTUP_TIME
		FROM
			M_SIZE
	</M_CB_MSIZE001>
	
	<!-- select for combobox -->
	<M_CB_MSIZE002>
		SELECT
			SIZE_CODE,
			SIZE_KANA,
			SIZE_NAME,
			SIZE_TNAME,
			DSPORDER_NO,
			LCLS_CODE,
			MCLS_CODE,
			SCLS_CODE,
			OLD_CODE,
			SEARCHIDX,
			USE_FLG,
			ADD_USER,
			ADD_PC,
			ADD_DATE,
			ADD_TIME,
			LASTUP_USER,
			LASTUP_PC,
			LASTUP_DATE,
			LASTUP_TIME
		FROM
			M_SIZE
		WHERE
			USE_FLG = '0' AND
			LCLS_CODE = ? AND
			MCLS_CODE = ?
	</M_CB_MSIZE002>

	
<!-- START : add by HUNG NV 2010.07.22 -->
	<M_CB_MSUPP500>
	SELECT SUPP_CODE, SUPP1_NAME, SUPP2_NAME 
	FROM M_SUPP
	WHERE SUPP_CODE
	IN
	(
		SELECT SUPP1_CODE from M_SPPROD
		WHERE 
			LCLS_CODE = ?
			AND
			MCLS_CODE = ?
			AND 
			USE_FLG != 1
		UNION 
		SELECT SUPP2_CODE from M_SPPROD
		WHERE 
			LCLS_CODE = ?
			AND
			MCLS_CODE = ?
			AND 
			USE_FLG != 1
		UNION 
		SELECT SUPP3_CODE from M_SPPROD
		WHERE 
			LCLS_CODE = ?
			AND
			MCLS_CODE = ?
			AND 
			USE_FLG != 1
		UNION 
		SELECT SUPP4_CODE from M_SPPROD
		WHERE 
			LCLS_CODE = ?
			AND
			MCLS_CODE = ?
			AND 
			USE_FLG != 1
		UNION 
		SELECT SUPP5_CODE from M_SPPROD
		WHERE 
			LCLS_CODE = ?
			AND
			MCLS_CODE = ?
			AND 
			USE_FLG != 1
	)
	</M_CB_MSUPP500>
	
	<M_CB_TR_ORDRH500>
	SELECT 
		ORDR_NO 
	FROM 
		TR_ORDRH
	WHERE 		
		CUST_CODE = ?
		AND
		SHIP_NO = ?
		AND
		DRAW_TYPE = ?
	</M_CB_TR_ORDRH500>
<!-- END : add by HUNG NV 2010.07.22 -->

	
<M_CB_MENUPRT_001>
	SELECT
 		MT.MENUGRP_CODE,
 		MT.MENUEXE_CODE,
 		ME.MENUEXE_NAME,
        ML.C_DATA
	FROM
		M_MENURPT AS MT
		LEFT JOIN M_MENUEXE AS ME ON MT.MENUGRP_CODE = ME.MENUGRP_CODE 
    		AND MT.MENUEXE_CODE = ME.MENUEXE_CODE
        LEFT JOIN M_CTL AS ML ON MT.PRT_CTL = ML.C_KEY AND ML.USERID = 'SYSTEM'
	ORDER BY
		MT.DSPORDER_NO
</M_CB_MENUPRT_001>


<M_CB_BENDERR001>
	SELECT 
		BENDERR 
	FROM 
		M_PDBE
	WHERE 		
		PDMETER = ?
</M_CB_BENDERR001>


<M_CB_MAKIN_TYPE>
	SELECT NAME_CODE
			,NAME_TNAME
			,DEFAULT_TYPE
	FROM M_NAME
	WHERE NAMECLS_CODE = 'MKIN'
			AND DSP_FLG = '0'
	ORDER BY DSPORDER_NO
</M_CB_MAKIN_TYPE>



	<!-- select SIZE_NAME from M_PROD -->
	<M_CB_SIZE_NAME>
		SELECT 
			DISTINCT
			CUST_CODE,
			CASE RTRIM(LCLS_CODE) + RTRIM(MCLS_CODE)
				WHEN '101' THEN CAST(HEIGHT_QTY AS VARCHAR) + ' × ' + CAST(WIDTH_QTY AS VARCHAR)
				ELSE CAST(SIZE_QTY AS VARCHAR) + ' × ' + CAST(TCKN_QTY AS VARCHAR) 
			END AS SIZE_NAME,
			SIZE_QTY,
			TCKN_QTY,
			HEIGHT_QTY,
			WIDTH_QTY 
		FROM
			M_PROD
		WHERE
			USE_FLG = '0' AND
			LCLS_CODE = ? AND
			MCLS_CODE = ? AND
			PDMETER = ? AND
			MATER_CODE = ? AND
			STD_CODE = ? AND
			TYPE_CODE = ? AND
			((SIZE_QTY > 0 AND TCKN_QTY > 0) OR (HEIGHT_QTY > 0 AND WIDTH_QTY > 0))
		ORDER BY HEIGHT_QTY, WIDTH_QTY DESC, SIZE_QTY ,TCKN_QTY
	</M_CB_SIZE_NAME>
	
	<!-- select SIZE_NAME from M_PROD, compare CUST_CODE -->
	<M_CB_SIZE_NAME_001>
		SELECT 
			DISTINCT
			CUST_CODE,
			CASE RTRIM(LCLS_CODE) + RTRIM(MCLS_CODE)
				WHEN '101' THEN CAST(HEIGHT_QTY AS VARCHAR) + ' × ' + CAST(WIDTH_QTY AS VARCHAR)
				ELSE CAST(SIZE_QTY AS VARCHAR) + ' × ' + CAST(TCKN_QTY AS VARCHAR) 
			END AS SIZE_NAME,
			SIZE_QTY,
			TCKN_QTY,
			HEIGHT_QTY,
			WIDTH_QTY 
		FROM
			M_PROD
		WHERE
			USE_FLG = '0' AND
			CUST_CODE = ? AND
			LCLS_CODE = ? AND
			MCLS_CODE = ? AND
			PDMETER = ? AND
			MATER_CODE = ? AND
			STD_CODE = ? AND
			TYPE_CODE = ? AND
			((SIZE_QTY > 0 AND TCKN_QTY > 0) OR (HEIGHT_QTY > 0 AND WIDTH_QTY > 0))
		ORDER BY HEIGHT_QTY, WIDTH_QTY DESC, SIZE_QTY ,TCKN_QTY
	</M_CB_SIZE_NAME_001>

	<M_DECPLC001>
		SELECT 
			   NAME_CODE,	
			   NAME_NAME,
			   DEFAULT_TYPE			
		FROM M_NAME
		WHERE NAMECLS_CODE = 'DEC_PLC'	
		ORDER BY NAME_NAME
		
	</M_DECPLC001>
	
	<!-- b: List G0103 -->
	<M_CB_PG01001>
	  SELECT G0101
		   , G0103 
	    FROM PG01
	ORDER BY G0101
	</M_CB_PG01001>
	<!-- e: List G0103 -->

</System>
