<?xml version="1.0" encoding="utf-8" ?>
<System>
	<F_SLP001>
		SELECT
			RTRIM(SLP.SLP_TYPE)    AS SLP_TYPE
			,RTRIM(SLP.SLPDATE)    AS SLPDATE
			,COALESCE(SLP.SLPNEW,0) AS SLPNEW
			,COALESCE(SLP.SLPMIN,0) AS SLPMIN
			,COALESCE(SLP.SLPMAX,0) AS SLPMAX
		FROM
			F_SLP AS SLP
		WHERE
			SLP.SLP_TYPE = ? 
			AND SLP.SLPDATE = ?
	</F_SLP001>
	<F_SLP002>
		UPDATE
			F_SLP
		SET
			 SLPNEW = ?
		    ,LASTUP_USER = ?
			,LASTUP_PC = ?
		    ,LASTUP_DATE = ?
		    ,LASTUP_TIME = ?
		WHERE
			SLP_TYPE = ? 
			AND SLPDATE = ?
	</F_SLP002>
	<F_SLP003>
		SELECT
			 F.SLP_TYPE AS SLP_TYPE
			,F.SECT_CODE AS SECT_CODE
                        ,F.SECT1_CODE AS SECT1_CODE
                        ,F.SECT2_CODE AS SECT2_CODE
                        ,F.SECT3_CODE AS SECT3_CODE
                        ,F.SECT4_CODE AS SECT4_CODE
                        ,SE.SECT_NAME AS SECT_NAME
			,F.SLP_NAME AS SLP_NAME
			,COALESCE(F.SLPNEW,0) AS SLPNEW
			,COALESCE(F.SLPMIN,0) AS SLPMIN
			,COALESCE(F.SLPMAX,0) AS SLPMAX
			,F.ADD_USER
			,F.ADD_PC
			,F.ADD_DATE
			,F.ADD_TIME
			,F.LASTUP_USER
			,F.LASTUP_PC
			,F.LASTUP_DATE
			,F.LASTUP_TIME
		FROM
			F_SLP AS F
                LEFT JOIN  M_SECT AS SE ON F.SECT_CODE = SE.SECT_CODE
		$WHERE
	</F_SLP003>
	<F_SLP004>
		INSERT INTO F_SLP(
			SLP_TYPE,
			SECT_CODE,
                        SECT1_CODE,
                        SECT2_CODE,
                        SECT3_CODE,
                        SECT4_CODE,
			SLP_NAME,
			SLPNEW,
			SLPMIN,
			SLPMAX,
			ADD_USER,
			ADD_PC,
			ADD_DATE,
			ADD_TIME,
			LASTUP_USER,
			LASTUP_PC,
			LASTUP_DATE,
			LASTUP_TIME
			)
		VALUES
			 (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
	</F_SLP004>
	<F_SLP005>
		UPDATE
			F_SLP
	        SET
                SLP_NAME = ?,
				SLPNEW = ?,
				SLPMIN = ?,
				SLPMAX = ?,
				LASTUP_USER = ?,
				LASTUP_PC = ?,
				LASTUP_DATE = ?,
				LASTUP_TIME = ?
		WHERE
			SLP_TYPE = ?
		AND
			SECT_CODE = ?
                AND
                        SECT1_CODE = ?
                AND
                        SECT2_CODE = ?
                AND
                        SECT3_CODE = ?
                AND
                        SECT4_CODE = ?
	</F_SLP005>
       	<F_SLP006>
		DELETE FROM
		    F_SLP
		WHERE
		    SECT_CODE = ?
	</F_SLP006>
	
	
	
	<F_SLP500>
		SELECT 
			RTRIM(SLP.SLP_TYPE) AS SLP_TYPE,
			RTRIM(SLP.SLPDATE) AS SLPDATE,
			RTRIM(SLP.SLP_NAME) AS SLP_NAME,
			COALESCE(SLP.SLPNEW, 0) AS SLPNEW,
			COALESCE(SLP.SLPMIN, 0) AS SLPMIN,
			COALESCE(SLP.SLPMAX, 0) AS SLPMAX,
			RTRIM(SLP.ADD_USER) AS ADD_USER,
			RTRIM(SLP.ADD_PC) AS ADD_PC,
			COALESCE(SLP.ADD_DATE, 0) AS ADD_DATE,
			COALESCE(SLP.ADD_TIME, 0) AS ADD_TIME,
			RTRIM(SLP.LASTUP_USER) AS LASTUP_USER,
			RTRIM(SLP.LASTUP_PC) AS LASTUP_PC,
			COALESCE(SLP.LASTUP_DATE, 0) AS LASTUP_DATE,
			COALESCE(SLP.LASTUP_TIME, 0) AS LASTUP_TIME
		FROM
			F_SLP SLP
		WHERE
			SLP.SLP_TYPE = ? 
			AND SLP.SLPDATE = ?
	</F_SLP500>
	<F_SLP501>
		SELECT 
			RTRIM(SLP.SLP_TYPE) AS SLP_TYPE,
			RTRIM(SLP.SLPDATE) AS SLPDATE,
			RTRIM(SLP.SLP_NAME) AS SLP_NAME,
			COALESCE(SLP.SLPNEW, 0) AS SLPNEW,
			COALESCE(SLP.SLPMIN, 0) AS SLPMIN,
			COALESCE(SLP.SLPMAX, 0) AS SLPMAX,
			RTRIM(SLP.ADD_USER) AS ADD_USER,
			RTRIM(SLP.ADD_PC) AS ADD_PC,
			COALESCE(SLP.ADD_DATE, 0) AS ADD_DATE,
			COALESCE(SLP.ADD_TIME, 0) AS ADD_TIME,
			RTRIM(SLP.LASTUP_USER) AS LASTUP_USER,
			RTRIM(SLP.LASTUP_PC) AS LASTUP_PC,
			COALESCE(SLP.LASTUP_DATE, 0) AS LASTUP_DATE,
			COALESCE(SLP.LASTUP_TIME, 0) AS LASTUP_TIME
		FROM
			F_SLP SLP
	</F_SLP501>
	<F_SLP502>
	UPDATE
			F_SLP
	        SET
                SLP_NAME = ?,
				SLPNEW = ?,
				SLPMIN = ?,
				SLPMAX = ?,
				LASTUP_USER = ?,
				LASTUP_PC = ?,
				LASTUP_DATE = ?,
				LASTUP_TIME = ?
		WHERE
			SLP_TYPE = ? 
			AND SLPDATE = ?
	</F_SLP502>

	<F_SLP503>
		SELECT 
			RTRIM(SLP.CUST_CODE) AS CUST_CODE,
			RTRIM(MT.CUSTR_NAME) AS CUSTR_NAME,
			RTRIM(SLP.DRAW_TYPE) AS DRAW_TYPE,
			COALESCE(MW.NAME_NAME,'') AS DRAW_NAME,
			COALESCE(SLP.SLPNEW, 0) AS SLPNEW,
			COALESCE(SLP.SLPMIN, 0) AS SLPMIN,
			COALESCE(SLP.SLPMAX, 0) AS SLPMAX,
			RTRIM(SLP.ADD_USER) AS ADD_USER,
			RTRIM(SLP.ADD_PC) AS ADD_PC,
			COALESCE(SLP.ADD_DATE, 0) AS ADD_DATE,
			COALESCE(SLP.ADD_TIME, 0) AS ADD_TIME,
			RTRIM(SLP.LASTUP_USER) AS LASTUP_USER,
			RTRIM(SLP.LASTUP_PC) AS LASTUP_PC,
			COALESCE(SLP.LASTUP_DATE, 0) AS LASTUP_DATE,
			COALESCE(SLP.LASTUP_TIME, 0) AS LASTUP_TIME
		FROM
			F_SLPODR SLP
		LEFT JOIN  M_CUST AS MT ON MT.CUST_CODE = SLP.CUST_CODE
		LEFT JOIN (select * from M_NAME where NAMECLS_CODE = 'DRAW' AND DSP_FLG ='0') AS MW ON SLP.DRAW_TYPE =  MW.NAME_CODE
	</F_SLP503>
	
		<F_SLP504>
	UPDATE
			F_SLPODR
	        SET
				SLPNEW = ?,
				SLPMIN = ?,
				SLPMAX = ?,
				LASTUP_USER = ?,
				LASTUP_PC = ?,
				LASTUP_DATE = ?,
				LASTUP_TIME = ?
		WHERE
			CUST_CODE = ? 
			AND DRAW_TYPE = ?
	</F_SLP504>
	
	<F_SLP505>
		SELECT 
			COALESCE(SLP.CUST_CODE,'') AS CUST_CODE,
			COALESCE(SLP.DRAW_TYPE,'') AS DRAW_TYPE,
			COALESCE(SLP.SLPNEW, 0) AS SLPNEW,
			COALESCE(SLP.SLPMIN, 0) AS SLPMIN,
			COALESCE(SLP.SLPMAX, 0) AS SLPMAX,
			RTRIM(SLP.ADD_USER) AS ADD_USER,
			RTRIM(SLP.ADD_PC) AS ADD_PC,
			COALESCE(SLP.ADD_DATE, 0) AS ADD_DATE,
			COALESCE(SLP.ADD_TIME, 0) AS ADD_TIME,
			RTRIM(SLP.LASTUP_USER) AS LASTUP_USER,
			RTRIM(SLP.LASTUP_PC) AS LASTUP_PC,
			COALESCE(SLP.LASTUP_DATE, 0) AS LASTUP_DATE,
			COALESCE(SLP.LASTUP_TIME, 0) AS LASTUP_TIME
		FROM
			F_SLPODR SLP
		WHERE
			SLP.CUST_CODE = ? 
			AND SLP.DRAW_TYPE = ?
	</F_SLP505>
	
	<F_SLP506>
		SELECT
			RTRIM(SLP.CUST_CODE)    AS CUST_CODE
			,RTRIM(SLP.DRAW_TYPE)    AS DRAW_TYPE
			,COALESCE(SLP.SLPNEW,0) AS SLPNEW
			,COALESCE(SLP.SLPMIN,0) AS SLPMIN
			,COALESCE(SLP.SLPMAX,0) AS SLPMAX
		FROM
			F_SLPODR AS SLP
		WHERE
			SLP.CUST_CODE = ? 
			AND 
			SLP.DRAW_TYPE = ?
	</F_SLP506>
	
	
	<F_SLP509>
		INSERT INTO F_SLPODR(
			CUST_CODE
			, DRAW_TYPE
			, SLPNEW
			, SLPMIN
			, SLPMAX			
			, ADD_USER
			, ADD_PC
			, ADD_DATE
			, ADD_TIME
			, LASTUP_USER
			, LASTUP_PC
			, LASTUP_DATE
			, LASTUP_TIME)
			VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?)
	</F_SLP509>
	
	<F_SLP510>
		DELETE FROM F_SLPODR
		WHERE 
			CUST_CODE = ?
	</F_SLP510>
</System>
